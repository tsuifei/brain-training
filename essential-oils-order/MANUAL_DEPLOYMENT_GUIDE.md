# 手動部署指南 - 精油訂購系統

## 📋 準備工作

請確保你已經：
- ✅ 使用 `hello2paris@gmail.com` 登入 Google 帳號
- ✅ 已開啟本文件旁邊的三個原始檔案以便複製

---

## 🚀 部署步驟

### 步驟 1：創建新的 Apps Script 專案

1. 在瀏覽器中開啟：**https://script.google.com**
2. 點擊左上角「**+ 新專案**」按鈕
3. 等待編輯器開啟

✅ **檢查點**：你應該看到一個新的專案，預設有 `function myFunction() {}` 的程式碼

---

### 步驟 2：設定專案名稱

1. 點擊左上角的「**無標題專案**」
2. 輸入：**精油訂購系統**
3. 按 Enter 或點擊外部儲存

✅ **檢查點**：左上角應該顯示「精油訂購系統」

---

### 步驟 3：複製 Code.gs

1. 在 Apps Script 編輯器中，選取並**刪除**所有現有程式碼
2. 在本地打開檔案：`essential-oils-order/Code.gs`
3. **複製全部內容**（共 488 行）
4. **貼上**到 Apps Script 編輯器中
5. 按 **Ctrl+S (Windows)** 或 **Cmd+S (Mac)** 儲存

✅ **檢查點**：
- 編輯器顯示「已儲存的變更」
- 第 1 行應該是：`/**`
- 第 10 行應該包含：`const ADMIN_EMAIL = 'hello2paris@gmail.com';`

---

### 步驟 4：新增 Index.html

1. 在左側面板，點擊「**檔案**」旁的 **+** 號
2. 選擇「**HTML**」
3. 輸入檔案名稱：**Index**（不要加 .html）
4. 點擊「新增」

5. 在本地打開檔案：`essential-oils-order/Index.html`
6. **複製全部內容**（共 616 行）
7. **貼上**到新建的 Index.html 編輯器中
8. 按 **Ctrl+S** 或 **Cmd+S** 儲存

✅ **檢查點**：
- 左側檔案列表應該顯示「Index.html」
- 第 1 行應該是：`<!DOCTYPE html>`
- 檔案包含完整的 HTML、CSS 和 JavaScript

---

### 步驟 5：設定 appsscript.json

1. 點擊左側的「**專案設定**」（齒輪圖示 ⚙️）
2. 找到「**以資訊清單檔顯示 "appsscript.json"**」
3. **勾選**這個選項
4. 回到「**編輯器**」標籤

5. 在左側檔案列表，點擊「**appsscript.json**」
6. **刪除**所有現有內容
7. 在本地打開檔案：`essential-oils-order/appsscript.json`
8. **複製全部內容**
9. **貼上**到編輯器中
10. 按 **Ctrl+S** 或 **Cmd+S** 儲存

✅ **檢查點**：appsscript.json 應該包含：
```json
{
  "timeZone": "Asia/Taipei",
  "dependencies": {},
  "exceptionLogging": "STACKDRIVER",
  "runtimeVersion": "V8",
  "webapp": {
    "access": "ANYONE",
    "executeAs": "USER_DEPLOYING"
  }
}
```

---

### 步驟 6：部署為 Web 應用程式

1. 點擊右上角「**部署**」按鈕
2. 選擇「**新增部署作業**」

3. 在彈出視窗中：
   - 點擊「**選取類型**」旁的齒輪圖示
   - 選擇「**網頁應用程式**」

4. 設定部署資訊：
   - **說明**：精油訂購系統 v1.0
   - **執行身分**：**我**
   - **具有存取權的使用者**：**任何人**

5. 點擊「**部署**」

---

### 步驟 7：授權應用程式（首次部署）

第一次部署時需要授權：

1. 點擊「**授權存取權**」
2. 選擇 **hello2paris@gmail.com** 帳號
3. 看到警告訊息時，點擊「**進階**」
4. 點擊「**前往精油訂購系統（不安全）**」
5. 點擊「**允許**」

**注意**：這個「不安全」警告是正常的，因為這是你自己開發的應用程式，Google 還沒有驗證。

---

### 步驟 8：取得訂購系統網址 🎉

授權完成後：

1. 你會看到「部署作業」視窗
2. 找到「**網頁應用程式**」下方的 URL
3. **複製這個 URL**（格式類似：`https://script.google.com/macros/s/xxxxx/exec`）

**這就是你的精油訂購系統網址！** ✅

---

## 🧪 測試系統

### 測試步驟：

1. 開啟你剛才複製的訂購系統 URL
2. 使用 Google 帳號登入
3. 確認看到：
   - 顯示登入的 Email
   - 8 種精油產品列表
   - 購物車功能正常
4. 嘗試加入一項商品到購物車
5. 填寫客戶資訊
6. 提交測試訂單

### 檢查訂單記錄：

1. 開啟 Google Drive：https://drive.google.com
2. 找到「**精油訂購APP**」資料夾
3. 打開「**精油訂單記錄**」Sheet
4. 確認測試訂單已記錄

✅ 如果看到訂單，恭喜！系統部署成功！

---

## 📝 重要資訊

### 你的部署資訊：

- **專案名稱**：精油訂購系統
- **管理帳號**：hello2paris@gmail.com
- **資料夾**：精油訂購APP
- **訂單記錄**：精油訂單記錄（Google Sheet）
- **訂購網址**：（你在步驟 8 複製的 URL）

### 下一步：

1. **分享訂購網址**給你的客戶
2. **監控訂單**：定期檢查「精油訂單記錄」Sheet
3. **管理產品**：如需修改產品，可以在 Apps Script 編輯器執行 `createProductListSheet` 函數

---

## 🔧 後續更新

如果需要修改程式碼：

1. 在 Apps Script 編輯器中修改
2. 儲存變更
3. 重新部署：
   - 點擊「部署」→「管理部署作業」
   - 點擊「編輯」（鉛筆圖示）
   - 更新版本號
   - 點擊「部署」

**網址不會改變**，客戶可以繼續使用原來的 URL。

---

## 🆘 需要協助？

如果遇到問題：

1. 檢查 Apps Script 執行日誌：點擊「執行作業」查看錯誤
2. 確認所有檔案都已正確複製
3. 確認部署設定：執行身分=「我」，存取權=「任何人」

---

**部署完成後，記得保存你的訂購系統 URL！** 🎉
